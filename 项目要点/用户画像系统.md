#### 用户画像系统

1.  目标解读

   先明确用户画像服务于企业的对象,根据业务需求,未来产品建设目标和用户画像的预期效果

2.  任务分解以及需求调研

   结合产品现有的业务体系,和数据字典规约实体和标签之间的关联关系,明确分析维度.

3.  需求场景讨论与明确

   明确画像的应用场景,最终开发出来的标签内容与应用方式.

4. 应用场景和数据口径的确认

   确定了最终的标签纬度以及标签类型之后，需要根据业务以及数据仓库中的表，明确场景的数据口径。

   需要说明应用场景，标签开发的模型，设计到的数据库与表，应用实施流程等等。

5. 特征选取与数据模型落地

   数据挖掘人员对场景进行数据建模,写好HQL逻辑。将模型写入临时表，抽取数据，并校验确定是否满足业务场景需求。

6. 线下模型数据验收与测试

   数据仓库团队将数据落表之后，进行定时任务的调度。

7.  线上发布以及效果追踪

##### 用户标签的存储

**Hive**

使用hive表进行存储,包括用户标签表,标签聚合表,人群计算表

**Mysql**

mysql在用户画像中包含如下几种类型

+ 画像标签元数据
+ 结果集的校验(标签量级别的监控,Hive同步到Hbase的校验,数据波动的校验)
+ 同步到业务系统中的数据

##### 性能优化

1.  数据倾斜

2.  hive小文件的处理

   配置参数,对输出进行合并

   ```sql
   set hive.merge.mapfiles=true; 
   set hive.merge.mapredfiles=true; 
   set hive.merge.size.per.task=64000000; 
   ```
   

#### 用户画像

##### 用户行为标签

| 标签英文名称            | 标签中文名称     | 标签主题 | 标签类型         | 开发方式 | 是否为互斥类型标签 |
| ----------------------- | ---------------- | -------- | ---------------- | -------- | ------------------ |
| order good discuss      | 订单好评         | 用户行为 | 订单评价         | 统计     | 否                 |
| order bad discuss       | 订单差评         | 用户行为 | 订单评价         | 统计     | 否                 |
| normal buy              | 首单正常购买     | 用户行为 | 首单营销方式     | 统计     | 否                 |
| coupon                  | 首单优惠券       | 用户行为 | 首单营销方式     | 统计     | 否                 |
| element                 | 首单红包         | 用户行为 | 首单营销方式     | 统计     | 否                 |
| last 30d buy frequency  | 近30天购买次数   | 用户行为 | 近30天行为       | 统计     | 否                 |
| last 30d buy amount     | 近30天消费金额   | 用户行为 | 近30天行为       | 统计     | 否                 |
| last 30d active days    | 近30天活跃天数   | 用户行为 | 近30天行为       | 统计     | 否                 |
| last 7d buy frequency   | 近7天购买次数    | 用户行为 | 近7天行为        | 统计     | 否                 |
| last 7d buy amount      | 近7天消费金额    | 用户行为 | 近7天行为        | 统计     | 否                 |
| last 7d active days     | 近7天活跃天数    | 用户行为 | 近7天行为        | 统计     | 否                 |
| last 3d buy frequency   | 近3天购买次数    | 用户行为 | 近7天行为        | 统计     | 否                 |
| last 3d buy amount      | 近3天消费金额    | 用户行为 | 近7天行为        | 统计     | 否                 |
| last 3d active days     | 近3天活跃天数    | 用户行为 | 近7天行为        | 统计     | 否                 |
| first order to now days | 首单距今时间     | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| last order to now days  | 尾单距今时间     | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| add cart no order       | 加购未下单       | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| order no pay            | 下单未支付       | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| browse no buy           | 浏览未购买       | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| unsuccessful payment    | 未付款成功       | 用户行为 | 近5日购买阶段    | 统计     | 否                 |
| high active morning     | 上午活跃         | 用户行为 | 高频活跃时间段   | 统计     | 否                 |
| high active noon        | 中午活跃         | 用户行为 | 高频活跃时间段   | 统计     | 否                 |
| high active afternoon   | 下午活跃         | 用户行为 | 高频活跃时间段   | 统计     | 否                 |
| high active evening     | 晚上活跃         | 用户行为 | 高频活跃时间段   | 统计     | 否                 |
| high active dawn        | 凌晨活跃         | 用户行为 | 高频活跃时间段   | 统计     | 否                 |
| single order min amount | 单笔订单最小金额 | 用户行为 | 单笔订单最小金额 | 统计     | 否                 |
| single order max amount | 单笔订单最小金额 | 用户行为 | 单笔订单最大金额 | 统计     | 否                 |

##### 用户属性标签

| 标签英文名称                     | 标签中文名称             | 标签类型 | 开发方式 | 是否互斥 |
| -------------------------------- | ------------------------ | -------- | -------- | -------- |
| male                             | 男                       | 性别     | 分类     | 是       |
| female                           | 女                       | 性别     | 分类     | 是       |
| membership gift                  | 赠送会员                 | 会员     | 分类     | 是       |
| membership conpensate            | 补偿会员                 | 会员     | 分类     | 是       |
| membership history               | 历史会员                 | 会员     | 分类     | 是       |
| no membership                    | 非会员                   | 会员     | 分类     | 是       |
| no1_membership                   | 会员等级 1               | 会员     | 分类     | 是       |
| no2_membership                   | 会员等级 2               | 会员     | 分类     | 是       |
| no3_membership                   | 会员等级 3               | 会员     | 分类     | 是       |
| high returned user               | 高退货用户               | 会员     | 统计     | 否       |
| high complaint user              | 高投诉用户               | 会员     | 统计     | 否       |
| losing user                      | 即将流式用户             | 会员     | 统计     | 否       |
| lost user after first buy        | 首次购买后流式用户       | 会员     | 统计     | 否       |
| days between last active and now | 最近一次活跃距离今天天数 | 会员     | 统计     | 否       |
| days between last buy and now    | 最近一次购买距离今天天数 | 会员     | 统计     | 否       |
| high active                      | 高活跃度                 | 活跃度   | 统计     | 是       |
| middle active                    | 中活跃度                 | 活跃度   | 统计     | 是       |
| low active                       | 低活跃度                 | 活跃度   | 统计     | 是       |
| high lost                        | 高流失                   | 流失度   | 统计     | 是       |
| middle lost                      | 中流失                   | 流失度   | 统计     | 是       |
| low lost                         | 低流失                   | 流式度   | 统计     | 是s      |

##### 用户消费维度（业务相关）

| 标签中文名称 | 标签类型 | 开发方式 | 是否互斥 |
| ------------ | -------- | -------- | -------- |
|              | 国内酒店 |          |          |
|              | 国际酒店 |          |          |
|              | 国内机票 |          |          |
|              | 国际机票 |          |          |

##### 用户风控维度



