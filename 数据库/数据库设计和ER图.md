**数据库设计和ER图**

---

##### **设计过程**

1.  **设计阶段**

   + 刻画未来数据库用户的需求，为了完成这个任务数据库设计者需要同领域专家和用户进行深入沟通。
   + 设计者选择数据模型，并采用数据模型的概念，将这些需求转换为数据库概念。在**概念设计**阶段产生的模式提供了一个对企业的详细描述。使用实体-联系模型通常用于表示概念设计。
   + 完整的概念模式还需要指明企业的功能需求。在**功能需求规格说明**中,用户描述将在数据上进行各类操作.在概念设计阶段,设计者可以检查所有设计的模式,确保满足功能需求.
   + 从抽象数据模型到数据库实现的转换工厂在最后两个设计阶段中进行
     + **逻辑设计阶段**: 设计者将高层概念模式映射到使用数据库系统的实现数据模型上.
     + 设计者将得到的系统特点的数据库模式使用到后续的**物理设计阶段**.该阶段指明数据库的物理特征,包括文件组织格式和索引结构的选择.

2.  **设计选择**

   设计一个数据库模式的时候,必须确保两个主要的缺陷:

   + **冗余**

     一个不好的设计可能会重复信息,对于一个实体关系,如果冗余(多次且不必要)的关联就没有意义了.

   + **不完整**

     一个不好的设计可以使得某些方面难以建模甚至无法建模

##### 实体-联系模型

实体联系模型(ER数据模型)旨在方便数据块设计,通过允许定义代表数据块全局逻辑的*企业模式*实现的.

ER数据模型包含三个基本概念,实体集,联系集和属性.

1. 实体集

   **实体集**是相同类型的实体集合

   > 实体集可以不相交
   >
   > + 实体通过一组属性表示,属性时每个成员所拥有的描述性性质
   > + 每个实体的每个属性都有一个**值**
   > + 数据库包含一组实体集

2. 联系集

   **联系**是多个实体之间的相互关联

   **联系集**是相同类型联系的集合

3. 属性

   每个属性都有一个可取的集合称作属性的**域**,或者**值集**

   ER模型中属性可以按照类型分为:

   + **简单**和**复合**属性
   + **单值**和**多值**属性
   + **派生**属性
   
4. 强实体集和弱实体集

   具有主码的实体集称作强实体集,不具有构成主码的实体集称作弱实体集

##### 约束

ER企业模式可以定义一些数据库中数据必须满足的约束

1. 映射基数

   **映射基数**，表示一个实体通过一个联系集能够关联实体的个数

   映射基数在描述二元联系集的时候非常有用，尽管也可以描述多个联系集。

   对于实体集A合实体集B之间的二元关系集R来说，映射基数必然是:

   + **一对一**:

     A中的一个实体至多参与B中一个实体的关联,同理B中的一个实体页只能与A中的一个实体关联.

   + **一对多**:

     A中的一个实体可以与B中的任意数量实体关联,B中的实体至多与A中一个实体关联

   + **多对一**:

     A中的一个实体至多与B中的一个实体相关联,B中的一个实体可以关联任意一个A实体

   + **多对多**:

     A中的一个实体可以与B中的任意数量实体关联,B中的一个实体可以关联任意一个A实体

2. 参与约束

   如果实体集E中每个实体都参与到联系集R中至少一个联系中,实体集R在联系集R中参与称作**全部**的.如果只有部分实体参与,则称作是**部分**的.

3. 码

   必须需要有一个区分实体集中实体的方法,从概念上来说,实体之间是互异的,但是数据库观点来看,必须通过属性来表明.

   因此,一个实体的属性的值必须可以唯一标识该实体.也就是说,在一个实体集中不允许两个实体的素有属性值都相同.

   关系模式中**码**的概念直接适用于实体集,实体的码是一个足以区分每个实体的属性集.关系模式中**超码**,**候选码**,**主码**同样适用于实体集.

##### ER图

1. 基本结构

   ER图包含下述主要构件

   + **矩形**(两个部分的)表示实体集,上面标注实体集的名字,下面包含实体集的属性
   + **菱形**: 代码联系集
   + **未分割的矩形**: 代表联系集的属性
   + **线段**: 表示连接到实体集
   + **虚线**: 表示连接到联系集
   + **双线**: 表示联系集的参与度
   + **双菱形**: 弱实体集的标志性联系集

2. 映射基数

   + 一对一
   + 一对多
   + 多对一
   + 多对多

   <img src="E:\截图文件\映射关系.png" style="zoom:67%;" />

 3. 复合属性

    <img src="E:\截图文件\复杂属性.png" style="zoom:67%;" />

	4. 角色

    通过菱形和矩形之间的连线上进行标注来表示角色

    ![](E:\截图文件\角色.png)

    

ER图元素表:

<img src="E:\截图文件\ER元素图.png" style="zoom:67%;" />

  

##### 扩展ER图

1.  特化

   实体集中包含一些子集,子集中实体某方面区别于实体集的其他实体.例如,实体集中某个实体子集可能不被该实体集中所有实体共享的属性.

2.  概化

   特化的逆过程,设计过程自底向上进行,多个实体具有共同的特征,综合成一个较高的实体集.

3.  属性继承

   特化和概化产生的高层和低层实体间重要特性为**属性继承**.高层实体集被低层实体集**继承**.

   层次结构中,给定实体集作为低层实体集值参与到一个ISA联系中,这个图中实体集只具有**单继承**.如果参与到多个ISA关系,称作**多继承**.产生的结构称作**格**.

##### 统一建模语言UML**

实体联系图中有利于建模,UML是由对象管理组织主持开发的标准,包括:

+ **类图**

  与ER图类似

+ **用况图**

  用况图说明了用户和系统之间的交互,特别是用户执行的每一步操作

+ **活动图**

  说明了系统不同部分之间的任务流

+ **实现图**

  在软件架构图和硬件构件层说明了系统的各个组成部分以及它们之间的关系.