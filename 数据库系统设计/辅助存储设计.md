#### 存储器层次

1. 高速缓存

   一个典型的计算机有1M或者更多的高速缓存。

   分为

   + 版级高速缓存

     位于微处理器本身同一个芯片上的

   + 二级高速缓存

     与微处理器不在同一个芯片上

   访问平均时间为几纳秒

2. 主存储器

   平均访问时间为10-100ns

3. 辅助存储器

   磁盘和主存传送一个字节的时间在10ms左右,但是一次可以传送多个字节.

4. 第三级存储器

   用于处理PT级别读写容量.

#### 易丢失和非易丢失存储

易丢失存储(RAM)在切断电源的时候数据会丢失.非易丢失(ROM)在切断电源时不容易丢失.在DBMS中,即使是发生了错误,仍然能够保存数据.

原则上来说,三级存储和辅助存储都是非易丢失的,但是在DBMS中,数据库的任何修改都不能认为是最终有效的,直到该修改被存储到非易失存储中.

#### 虚拟存储器

操作系统管理虚拟存储器,使其一部分留在主存中,另一部分保留着磁盘上.内存和磁盘间的数据以数据块(页)的形式进行传送.

虚拟存储作用于磁盘和主存之间,不属于存储系统中.

#### 磁盘

大多数情况下辅助存储用的都是磁盘.

1. 磁盘的结构

   磁盘驱动器拥有两个重要的组件,一个是磁盘组合,另一个是磁头组合.磁盘组合由一个或者多个圆盘组成,围绕一个主轴进行旋转.

   磁盘组成磁道,磁道是单个盘片上的同心圆.半径相同的磁道构成柱面.

   磁道被组织成扇区.扇区又被间隙分割.扇区是读写的最小单位.

2. 磁盘存取特性

   存取一个磁盘块需要三个步骤,每一步都有延迟

   1. 磁盘控制器寻找磁道所在柱面的时间,即**寻道时间**
   2. 磁盘控制器等待访问第一个扇区旋转到磁头下.称为**旋转时间**.
   3. 当磁盘控制器读取或者写出数据时, 数据所在扇区和扇空间的空隙经过磁头时候,称为**传输时间**.

#### 辅存访问加速方法

1. 计算的IO模型

2. 按柱面进行组织

   如果我们选择单个磁道或者一个柱面上连续读取所有块,那么只需要考虑第一次寻道时间即可.

3. 使用多个磁盘

   如果使用多个磁盘,只要磁盘控制器,总线和主存储器以n倍速率进行数据处理.则n个磁盘的效果近似于一个磁盘执行了n次操作.

4. 磁盘镜像

   某些情况下,两个或者更多磁盘保留有相同的数据副本是有意义的.这些磁盘称作相互镜像.可增强设计的可靠性.

5. 磁盘调度算法

   让磁盘调度器进行控制选择合适的调度算法,对大量块请求进行调度.

6.  预先取和大规模缓冲

   预先取,有时也称为**双缓冲**. 一些应用中, 能够预先获取磁盘请求块的顺序. 如果这样, 就能在需要这些块之前将其调入主存. 得知请求顺序可以利用磁盘调度算法, 减少访问的平均时间.



#### 磁盘故障以及防御措施

> **间歇性故障: **读取或者写入一个扇区没有成功,但是经常反复尝试又能成功读写.
>
> **介质损坏: ** 故障一个或者多个二进制位永久损坏,无论尝试多少次,正确地读取一个扇区都是不可能的.
>
> **写中断: ** 当我们企图写入一个扇区,既不能正确的写, 也不能成功的检索之前的扇区.可能是写扇区的过程中发生了供电中断.
>
> **磁盘崩溃: ** 整个磁盘都不可读

