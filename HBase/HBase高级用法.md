#### 行键的设计

HBase有两类基本的设计，即**行键**和**列键**.两者都可以存储信息.一种是键本身存储的内容,另一种是键排列顺序.

磁盘上一个列族下的所有单元格都存储在**存储文件**上.不同的列族不会出现在一个存储文件中.因为HBase不存储任何表中没有值的单元格.同时单元格存储的时候保存了行键和列键.所以每个单元格单独存储了它在表中所处位置的相关信息.

同一个单元格的多个版本被单独存储在连续的单元格中.当单元格存储的时候,还需要添加必要的时间戳.单元格按照时间戳降序排序.所以读取的默认都是最新的列.

结构化信息的单元格在HBase中叫做KeyValue.其中不仅包含用户生成时设定的列和对应的值.也包含行键和时间戳信息.KeyValue存储时先按照行键排序,当一个行有多个单元格的时候,再按照列进行排序.

##### 高表和宽表

HBase中可以设计高表和宽表两种表.前者列少行多,后者列多行少.HBase只能按照行进行分片,所以高表更有优势.

##### 分页

用户可以在客户端指定`offset`和`limit`来筛选数据。

##### 关于时间序列的处理

当处理流式事件的时候，最常见的就是按照时间序列组织数据。这些数据的突出特点就是它们的行键代表了事件发生的时间。由于HBase数据组织方式的特点，在一段时间内会导致**读写热点**问题。

#### 辅助索引

HBase中通过存储新旧坐标之间的映射关系来实现辅助索引。当数据写入表的时候，需要更新映射表。在辅助索引表中查找行键，在原表中查找实际的数据。

#### 布隆过滤器

默认机制决定了一个存储文件是否包含特定的受限于可用块索引的行键。同时这个索引是相当粗粒度的，该索引只存储了文件包含的开始键。

使用布隆过滤器的好处就是，用户可以判断一个文件是否包含特定的行键。这个过滤器的特性是如果这个文件不包含这个行，会获得一个明确的答复。如果包含有这一行数据，会有一定几率的错误。

如果用户批量更新数据，使得一行数据每次只被写入到少数几个存储文件中，那么过滤器就能减少系统IO的操作。

<img src="E:\截图文件\布隆过滤器选择.png" style="zoom:67%;" />