#### Flume基本介绍

flume是一个分布式，可靠的，用于高效收集和聚合大量日志源数据到中央数据存储的系统。使用flume不仅可以显示限制日志数据的聚合。因为数据源是可以自定义的，flume可以传输大量事件数据。

##### 系统要求

1.  jdk 1.8+
2. 内存 - 可以高效地进行sources，sink，channel的配置
3. 磁盘空间 -  使用channel或者sink进行高效磁盘空间配置
4. 目录的权限 - 使用代理控制目录的读写权限

##### 基础架构

flume代理是一个JVM进程。flume的source消费的数据来自于外部的web服务器数据源。外部数据源会发送事件到flume，按照指定的flume格式。例如，Avro数据源可以接受avro数据源。

相似的数据量可以使用Thrift Flume数据源去接受Thrift数据源(或者是Thrift的RPC客户端).当Flume源接收到一个事件的时候,会存储到一个或者多个channel中.channel是一个被动的存储,可以保持事件直到被sink消费为止.

文件通道就是一个示例- 可以返回本地的文件系统.sink会移除channel的事件,并将其放置到一个外部的仓库(例如HDFS).或者发送作为下一个Flume Agent的数据源.

<img src="E:\截图文件\Flume基本单元.png" style="zoom:67%;" />

###### 可靠性

事件存储在每个agent的channel中.事件会被分发到下一个agent或者中断存储中.事件只有在传输到下一个环节之后才能够被移除.flume使用事务的方式,保证事件传输的可靠性,source和sink会被压缩到事务中.这个事务,存储和检索事件会分别放置在channel提供的不同事务中.

这个会保证事件集合点对点传输是可靠的.

###### 可恢复性

事件存储在channel中,channel会管理失败恢复的问题.flume支持本地文件系统返回的持久化文件通道.这个也是一个内存的内存通道,这个会简单地将事件存储到内存队列中,这个恢复的速度较快.

#### 搭建flume环境

##### 创建一个Agent

##### 配置组件

##### 连接组件

##### 启动Agent

##### 示例

##### 记录行式数据

##### 基于zookeeper的配置

##### 三方插件的使用

##### 数据消费

##### 设置多个Agent流

##### Agent合并

##### 流复用

